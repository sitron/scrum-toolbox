{% extends "SitronnierSmBoxBundle::layout.html.twig" %}

{% block body %}
<h1>{{ entity.project.title }}</h1>
<h3>Sprint {{ entity.index }}</h3>

<ul>
    {% if entity.status != 'CLOSED' %}
    <li>
        <a href="{{ path('day_new') }}?sprint={{ entity.id }}">
            Add new day
        </a>
    </li>
    {% endif %}
    <li>
    <a href="{{ path('sprint', {'project': entity.project.id}) }}">
            See all sprints for {{ entity.project.title }}
        </a>
    </li>
</ul>

<div class="key-figures">
    <table class="record-properties">
        <tbody>
            <tr>
                <th></th>
                <th>MD</th>
                <th>SP</th>
                <th>BV</th>
            </tr>
            <tr>
                <th class="label">Total</th>
                <td>{{ entity.mandays }}</td>
                <td>{{ entity.storypoints }}</td>
                <td>{{ entity.businessvalue }}</td>
            </tr>
            <tr>
                <th class="label">Burnt</th>
                <td><span class="sprint-burnt-md"></span></td>
                <td><span class="sprint-burnt-sp"></span></td>
                <td><span class="sprint-burnt-bv"></span></td>
            </tr>
            <tr>
                <th class="label">Burnt ratio</th>
                <td><span class="sprint-burnt-md-ratio"></span></td>
                <td><span class="sprint-burnt-sp-ratio"></span></td>
                <td><span class="sprint-burnt-bv-ratio"></span></td>
            </tr>
        </tbody>
    </table>
    <table class="record-properties">
        <tbody>
            <tr>
                <th></th>
                <th>Planed</th>
                <th>Actual</th>
            </tr>
            <tr>
                <th class="label">Velocity</th>
                <td><span class="sprint-velocity-planed"></span></td>
                <td><span class="sprint-velocity-actual"></span></td>
            </tr>
        </tbody>
    </table>
</div>

{% include "SitronnierSmBoxBundle:Stats:sprint.html.twig" with {'sprint': entity} %}

<ul class="record_actions">
    <li>
        <a href="{{ path('sprint_edit', { 'id': entity.id }) }}">Edit sprint data</a>
    </li>
    <li>
        <form action="{{ path('sprint_delete', { 'id': entity.id }) }}" method="post">
            {{ form_widget(delete_form) }}
            <button type="submit">Delete</button>
        </form>
    </li>
</ul>
{% endblock %}

{% block javascripts %}
{{ parent() }}
<script src="http://yui.yahooapis.com/3.4.1/build/yui/yui-min.js"></script>
<script src="{{ asset('/bundles/sitronniersmbox/js/smgraph4.js') }}" type="text/javascript"></script>
<script type="text/javascript">
    YUI().use('SprintChart', 'node', function (Y) {
        Y.SmbSprintChart.createChart('{{ jsSprint }}');
    });
</script>
{% endblock %}

