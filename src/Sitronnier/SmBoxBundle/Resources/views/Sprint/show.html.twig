{% extends "SitronnierSmBoxBundle::layout.html.twig" %}

{% block body %}
<h1>{{ sprint.project.title }}</h1>
<h3>Sprint {{ sprint.index }}</h3>

<ul>
    {% if sprint.status != 'CLOSED' %}
    <li>
        <a href="{{ path('day_new') }}?sprint={{ sprint.id }}">
            Add new day
        </a>
    </li>
    {% endif %}
    <li>
    <a href="{{ path('sprint', {'project': sprint.project.id}) }}">
            See all sprints for {{ sprint.project.title }}
        </a>
    </li>
</ul>

{% include "SitronnierSmBoxBundle:Sprint:keyData.html.twig" with {'sprint': sprint} %}

<div id="sprint-stats">
    <h3>Stats for sprint <span id="sprint-index">{{ sprint.index }}</span></h3>
    {% if sprint.days.count > 0 %}
        <div id="graph-canvas"></div>
        <a href="{{ path('sprint_print', {'id': sprint.id }) }}" class="print-chart">Print chart</a>
    {% else %}
        <p>No days registered for this sprint (<a href="{{ path('day_new') }}?sprint={{ sprint.id }}">add new day</a>)</p>
    {% endif %}
</div>

<ul class="record_actions">
    <li>
        <a href="{{ path('sprint_edit', { 'id': sprint.id }) }}">Edit sprint data</a>
    </li>
    <li>
        <form action="{{ path('sprint_delete', { 'id': sprint.id }) }}" method="post">
            {{ form_widget(delete_form) }}
            <button type="submit">Delete</button>
        </form>
    </li>
</ul>
{% endblock %}

{% block javascripts %}
{{ parent() }}
<script src="http://yui.yahooapis.com/3.4.1/build/yui/yui-min.js"></script>
<script src="{{ asset('/bundles/sitronniersmbox/js/sprintchart.js') }}" type="text/javascript"></script>
<script type="text/javascript">
    YUI().use('SprintChart', 'node', function (Y) {
        Y.SmbSprintChart.createChart('{{ jsSprint }}');
    });
</script>
{% endblock %}

